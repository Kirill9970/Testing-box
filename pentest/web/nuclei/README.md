# Автоматизация пентестинга с nuclei

## Структура
- `run_nuclei.sh` — скрипт для запуска nuclei в Docker с параметрами из .env
- `analyze_nuclei_report.py` — анализатор JSONL-отчёта nuclei, формирует подробный HTML-отчёт
- `output/` — директория для сохранения отчётов nuclei (JSONL)
- `README.md` — эта инструкция

## Быстрый старт
1. **Настройте переменные в `.env`** (пример):
   ```ini
   NUCLEI_TARGET_URL=http://localhost:8080
   NUCLEI_SEVERITY=info,low,medium,high,critical
   NUCLEI_TEMPLATES=tech-detect,misconfiguration,vulnerabilities
   NUCLEI_THREADS=20
   NUCLEI_TIMEOUT=20
   NUCLEI_OUTPUT=nuclei_report.jsonl
   ```
2. **Запустите сканирование:**
   ```bash
   ./run_nuclei.sh
   ```
   - Отчёт nuclei будет сохранён в `output/nuclei_report.jsonl`

3. **Сгенерируйте HTML-отчёт:**
   ```bash
   python3 analyze_nuclei_report.py output/nuclei_report.jsonl
   ```
   - HTML-отчёт появится в `../../../reports/pentest/nuclei/nuclei_report_<дата>.html`

## Описание HTML-отчёта
- В начале отчёта — краткая инструкция по чтению.
- **Секция "Список matcher-name, использованных в отчёте":**
  - Здесь перечислены все уникальные `matcher-name`, которые встречаются в findings.
  - Для каждого matcher выводится краткое пояснение (description из шаблона, если есть).
  - Это помогает быстро понять, какие типы совпадений были обнаружены и что они значат.
- Далее — подробные секции по каждой находке:
  - Название, описание, severity, CWE/CVE, matched URL, curl для воспроизведения, пример запроса/ответа, объяснение важности.

## Советы по интерпретации
- **Severity = info** — это не уязвимость, а технологический или конфигурационный детект.
- **Matchers** — это условия, по которым nuclei считает, что найдено совпадение (например, по содержимому ответа, заголовкам, коду ответа и т.д.).
- Если неясно, что значит matcher — смотрите описание рядом с ним или изучайте шаблон на [cloud.projectdiscovery.io/templates](https://cloud.projectdiscovery.io/templates).
- Для воспроизведения используйте curl-запрос из отчёта.

## Проблемы и решения
- Если отчёт пустой — проверьте доступность цели, корректность шаблонов и переменных в .env.
- Для сканирования локальных сервисов используется `network=host` (Linux).
- Если возникают ошибки с правами — убедитесь, что Docker и output/ доступны для записи.

## Полезные ссылки
- [Документация nuclei](https://nuclei.projectdiscovery.io/)
- [Каталог шаблонов](https://cloud.projectdiscovery.io/templates)
